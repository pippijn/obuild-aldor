--* From SMWATT%WATSON.vnet.ibm.com@yktvmv.watson.ibm.com  Fri Jun 24 13:59:54 1994
--* Received: from yktvmv-ob.watson.ibm.com by watson.ibm.com (AIX 3.2/UCB 5.64/930311)
--*           id AA18722; Fri, 24 Jun 1994 13:59:54 -0400
--* Received: from watson.vnet.ibm.com by yktvmv.watson.ibm.com (IBM VM SMTP V2R3)
--*    with BSMTP id 1321; Fri, 24 Jun 94 13:59:52 EDT
--* Received: from YKTVMV by watson.vnet.ibm.com with "VAGENT.V1.0"
--*           id <A.SMWATT.NOTE.VAGENT2.8551.Jun.24.13:59:47.-0400>
--*           for asbugs@watson; Fri, 24 Jun 94 13:59:50 -0400
--* Received: from YKTVMV by watson.vnet.ibm.com with "VAGENT.V1.0"
--*           id 8547; Fri, 24 Jun 1994 13:59:45 EDT
--* Received: from watson.ibm.com by yktvmv.watson.ibm.com
--*    (IBM VM SMTP V2R3) with TCP; Fri, 24 Jun 94 13:59:41 EDT
--* Received: by watson.ibm.com (AIX 3.2/UCB 5.64/900524)
--*           id AA22321; Fri, 24 Jun 1994 14:02:55 -0400
--* Date: Fri, 24 Jun 1994 14:02:55 -0400
--* From: smwatt@watson.ibm.com (Stephen Watt)
--* X-External-Networks: yes
--* Message-Id: <9406241802.AA22321@watson.ibm.com>
--* To: asbugs@watson.ibm.com
--* Subject: [4] Inlining from addends with manifest paremeters does not work. [imod0.as][v36--]

--@ Fixed  by: <Who> <Date>
--@ Tested by: <Name of new or existing file in test directory>
--@ Summary:   <Description of real problem and the fix>


--+ /*
--+  * C code generated by A# from file "imod.as".
--+  */
--+
--+ #include "foam_c.h"
--+
--+
--+ static FiProg C0_imod;
--+ static void CF0_imod();
--+
--+ static FiProg C1_IntegerModRep;
--+ static FiClos CF1_IntegerModRep();
--+
--+ static FiProg C2_IntegerModRep;
--+ static FiWord CF2_IntegerModRep();
--+
--+ static FiProg C3_addLevel0;
--+ static FiClos CF3_addLevel0();
--+
--+ static FiProg C4_addNameFn;
--+ static FiWord CF4_addNameFn();
--+
--+ static FiProg C5_addLevel1;
--+ static FiWord CF5_addLevel1();
--+
--+ static FiProg C6_coerce;
--+ static FiWord CF6_coerce();
--+
--+ static FiProg C7_zero_QMARK_;
--+ static FiWord CF7_zero_QMARK_();
--+
--+ static FiProg C8__EQ_;
--+ static FiWord CF8__EQ_();
--+
--+ static FiProg C9__TILDE__EQ_;
--+ static FiWord CF9__TILDE__EQ_();
--+
--+ static FiProg C10__PLUS_;
--+ static FiWord CF10__PLUS_();
--+
--+ static FiProg C11__MINUS_;
--+ static FiWord CF11__MINUS_();
--+
--+ static FiProg C12__PLUS_;
--+ static FiWord CF12__PLUS_();
--+
--+ static FiProg C13__MINUS_;
--+ static FiWord CF13__MINUS_();
--+
--+ static FiProg C14_lift;
--+ static FiWord CF14_lift();
--+
--+ static FiProg C15__LT__LT_;
--+ static FiWord CF15__LT__LT_();
--+
--+ static FiProg C16_inv;
--+ static FiWord CF16_inv();
--+
--+ static FiProg C17_SmallIntegerMod;
--+ static FiWord CF17_SmallIntegerMod();
--+
--+ static FiProg C18_addLevel0;
--+ static FiClos CF18_addLevel0();
--+
--+ static FiProg C19_addNameFn;
--+ static FiWord CF19_addNameFn();
--+
--+ static FiProg C20_addLevel1;
--+ static FiWord CF20_addLevel1();
--+
--+ static FiProg C21_defhash0;
--+ static FiSInt CF21_defhash0();
--+
--+ static FiProg C22_SmallIntegerMod;
--+ static void CF22_SmallIntegerMod();
--+
--+ static FiProg C23_addNameFn;
--+ static FiWord CF23_addNameFn();
--+
--+ static FiProg C24_coerce;
--+ static FiWord CF24_coerce();
--+
--+ static FiProg C25_coerce;
--+ static FiWord CF25_coerce();
--+
--+ static FiProg C26_integer;
--+ static FiWord CF26_integer();
--+
--+ static FiProg C27__HAT_;
--+ static FiWord CF27__HAT_();
--+
--+ static FiProg C28__SLASH_;
--+ static FiWord CF28__SLASH_();
--+
--+ static FiProg C29__STAR_;
--+ static FiWord CF29__STAR_();
--+
--+ static FiProg C30_IntegerMod;
--+ static FiWord CF30_IntegerMod();
--+
--+ static FiProg C31_addLevel0;
--+ static FiClos CF31_addLevel0();
--+
--+ static FiProg C32_addNameFn;
--+ static FiWord CF32_addNameFn();
--+
--+ static FiProg C33_addLevel1;
--+ static FiWord CF33_addLevel1();
--+
--+ static FiProg C34_defhash0;
--+ static FiSInt CF34_defhash0();
--+
--+ static FiProg C35_IntegerMod;
--+ static void CF35_IntegerMod();
--+
--+ static FiProg C36_addNameFn;
--+ static FiWord CF36_addNameFn();
--+
--+ static FiProg C37_coerce;
--+ static FiWord CF37_coerce();
--+
--+ static FiProg C38_coerce;
--+ static FiWord CF38_coerce();
--+
--+ static FiProg C39_integer;
--+ static FiWord CF39_integer();
--+
--+ static FiProg C40__STAR_;
--+ static FiWord CF40__STAR_();
--+
--+ static FiProg C41__HAT_;
--+ static FiWord CF41__HAT_();
--+
--+ static FiProg C42__SLASH_;
--+ static FiWord CF42__SLASH_();
--+
--+ static FiProg C43_lazyGetter2;
--+ static void CF43_lazyGetter2();
--+
--+ static FiProg C44_lazyFnGetter;
--+ static FiClos CF44_lazyFnGetter();
--+
--+ static FiProg C45_lazyGetter;
--+ static FiWord CF45_lazyGetter();
--+
--+ static FiProg C46_lazyFnGetter;
--+ static FiClos CF46_lazyFnGetter();
--+
--+ static FiProg C47_lazyGetter;
--+ static FiWord CF47_lazyGetter();
--+
--+ static FiProg C48_lazyFnGetter;
--+ static FiClos CF48_lazyFnGetter();
--+
--+ static FiProg C49_lazyGetter;
--+ static FiWord CF49_lazyGetter();
--+ typedef struct Fmt5  *PFmt5;
--+ typedef struct Fmt6  *PFmt6;
--+ typedef struct Fmt7  *PFmt7;
--+ typedef struct Fmt8  *PFmt8;
--+ typedef struct Fmt9  *PFmt9;
--+ typedef struct Fmt10  *PFmt10;
--+ typedef struct Fmt11  *PFmt11;
--+ typedef struct Fmt12  *PFmt12;
--+ typedef struct Fmt13  *PFmt13;
--+ typedef struct Fmt14  *PFmt14;
--+ typedef struct Fmt15  *PFmt15;
--+ typedef struct Fmt16  *PFmt16;
--+ typedef struct Fmt17  *PFmt17;
--+ typedef struct Fmt18  *PFmt18;
--+ typedef struct Fmt19  *PFmt19;
--+ typedef struct Fmt20  *PFmt20;
--+
--+ struct Fmt5 {
--+         FiSInt X0_size;
--+         FiWord X1_values;
--+ };
--+
--+ struct Fmt6 {
--+         FiWord X0_found;
--+         FiWord X1_value;
--+ };
--+
--+ struct Fmt7 {
--+         FiSInt X0_size;
--+         FiSInt X1_nsize;
--+         FiWord X2_values;
--+ };
--+
--+ struct Fmt8 {
--+         FiClos X0_inv;
--+         FiClos X1__LT__LT_;
--+         FiClos X2_lift;
--+         FiClos X3__MINUS_;
--+         FiClos X4__MINUS_;
--+         FiClos X5__PLUS_;
--+         FiClos X6__PLUS_;
--+         FiClos X7__TILDE__EQ_;
--+         FiClos X8__EQ_;
--+         FiClos X9_zero_QMARK_;
--+         FiClos X10_coerce;
--+         FiWord X11_1;
--+         FiWord X12_0;
--+         FiSInt X13;
--+ };
--+
--+ struct Fmt9 {
--+         FiWord X0_n;
--+ };
--+
--+ struct Fmt10 {
--+         FiWord X0_I;
--+         FiWord X1;
--+         FiClos X2__EQ_;
--+         FiClos X3__TILDE__EQ_;
--+         FiClos X4__LT__LT_;
--+         FiClos X5__LT_;
--+         FiWord X6_0;
--+         FiClos X7__PLUS_;
--+         FiClos X8_zero_QMARK_;
--+         FiClos X9__MINUS_;
--+         FiWord X10_1;
--+         FiClos X11__STAR_;
--+         FiClos X12_quo;
--+         FiClos X13_mod;
--+         FiWord X14_dom;
--+ };
--+
--+ struct Fmt11 {
--+         FiWord X0__PCENT_;
--+ };
--+
--+ struct Fmt12 {
--+         FiPtr X0_empty;
--+ };
--+
--+ struct Fmt13 {
--+         FiClos X0__STAR_;
--+         FiClos X1__SLASH_;
--+         FiClos X2__HAT_;
--+         FiClos X3_integer;
--+         FiClos X4_coerce;
--+         FiClos X5_coerce;
--+         FiWord X6_Rep;
--+         FiWord X7__PCENT_;
--+         FiClos X8_inv;
--+         FiWord X9_1;
--+         FiSInt X10;
--+         FiClos X11_power;
--+         FiWord X12_dom;
--+ };
--+
--+ struct Fmt14 {
--+         FiWord X0_n;
--+ };
--+
--+ struct Fmt15 {
--+         FiWord X0__PCENT_;
--+ };
--+
--+ struct Fmt16 {
--+         FiClos X0__SLASH_;
--+         FiClos X1__HAT_;
--+         FiClos X2__STAR_;
--+         FiClos X3_integer;
--+         FiClos X4_coerce;
--+         FiClos X5_coerce;
--+         FiWord X6_Rep;
--+         FiWord X7__PCENT_;
--+         FiClos X8_inv;
--+         FiWord X9_1;
--+         FiSInt X10;
--+         FiClos X11_power;
--+         FiWord X12_dom;
--+ };
--+
--+ struct Fmt17 {
--+         FiWord X0_n;
--+ };
--+
--+ struct Fmt18 {
--+         FiWord X0_domain;
--+         FiSInt X1_name;
--+         FiSInt X2_type;
--+         FiBool X3_flag;
--+         FiClos X4_self;
--+ };
--+
--+ struct Fmt19 {
--+         FiWord X0_Ring;
--+         FiWord X1_SingleInteger;
--+         FiClos X2_BinaryPowering;
--+         FiWord X3_Integer;
--+         FiWord X4;
--+         FiWord X5;
--+ };
--+
--+ struct Fmt20 {
--+         FiWord X0;
--+         FiWord X1;
--+ };
--+ extern FiClos G_OCS69_imod;
--+ static FiClos *pG_NQYQM_noOperation;
--+ extern FiClos G_9JSM3_imod__IntegerMod__7998;
--+ extern FiClos G_7PG3N_imod__SmallIntegerMod;
--+ extern FiClos G_87K1L_imod__IntegerModRep__6;
--+ static FiClos *pG_XIPRL_runtime;
--+ static FiClos *pG_QQHP2_rtCacheMake;
--+ static FiClos *pG_759EG_rtCacheCheck;
--+ static FiClos *pG_LD0B5_domainHash_BANG_;
--+ static FiClos *pG_GJ87F_domainName;
--+ static FiClos *pG_IK5ZM_stringConcat;
--+ static FiClos *pG_CSVBL_domainAddNameFn_BANG_;
--+ static FiClos *pG_XS55O_domainAddHash_BANG_;
--+ static FiClos *pG_PA5R2_domainAddExports;
--+ static FiClos *pG_IJHFC_domainMakeDispatch;
--+ static FiClos *pG_P63GL_boolean;
--+ static FiClos *pG_4NZQI_lazyGetExport_BANG_;
--+ static FiClos *pG_R3D1K_lazyForceImport;
--+ static FiClos *pG_BXNX_outport;
--+ static FiClos *pG_OGNYK_string;
--+ static FiClos *pG_NO017_basic;
--+ static FiClos *pG_6L1ZC_domainMake;
--+ static FiClos *pG_PV28S_rtCacheAdd;
--+ static FiClos *pG_WXLY5_categoryAddExports;
--+ static FiClos *pG_6M45D_categoryAddNameFn;
--+ static FiClos *pG_OPE1D_ascat;
--+ static FiWord *pG_WWV15_ascat__Ring__10110696;
--+ static FiClos *pG_YXGL3_categoryAddParents;
--+ static FiClos *pG_GOVLL_categoryMake;
--+ static FiClos *pG_V9SO_domainAddDefaults;
--+ static FiClos *pG_HAQ5R_sinteger;
--+ static FiWord *pG_7PJN6_sinteger__SingleInteg;
--+ static FiClos *pG_LKD03_domainAddParents;
--+ static FiClos *pG_WJ27Y_integer;
--+ static FiWord *pG_VJ6DK_integer__Integer__615;
--+ static FiClos *pG_FKD29_bpower;
--+ static FiClos *pG_2LA6D_bpower__BinaryPowerin;
--+ static FiClos *pG_JNB1W_machine;
--+ static FiClos *pG_BEY7_domainMakeDummy;
--+ static FiClos *pG_AK1EB_domainFill_BANG_;
--+ static FiClos *pG_1X2RM_domainGetExport_BANG_;
--+ static FiClos *pG_822GM_rtAddStrings;
--+ extern FiWord fputs();
--+ extern FiWord stdoutFile();
--+ extern FiWord fputc();
--+
--+
--+ FiClos G_87K1L_imod__IntegerModRep__6 = (FiClos) fiNil;
--+ FiClos G_7PG3N_imod__SmallIntegerMod = (FiClos) fiNil;
--+ FiClos G_9JSM3_imod__IntegerMod__7998 = (FiClos) fiNil;
--+ FiClos G_OCS69_imod;
--+
--+
--+ static void
--+ CF0_imod(e1)
--+         FiEnv e1;
--+ {
--+         PFmt7 T2, T3;
--+         FiWord *T0, *T1;
--+         PFmt19 l0;
--+         FiEnv e0;
--+         l0 = fiNew(struct Fmt19 );
--+         e0 = fiEnvPush(l0, e1);
--+         fiCCall0(void, (*pG_XIPRL_runtime));
--+         G_OCS69_imod = (FiClos) (*pG_NQYQM_noOperation);
--+         G_87K1L_imod__IntegerModRep__6 = fiClosMake(e0, C1_IntegerModRep);
--+         G_7PG3N_imod__SmallIntegerMod = fiClosMake(e0, C17_SmallIntegerMod);
--+         G_9JSM3_imod__IntegerMod__7998 = fiClosMake(e0, C30_IntegerMod);
--+         fiARRNEW_Word(T0, FiWord*, 16);
--+         fiARRNEW_Word(T1, FiWord*, 16);
--+         ((FiSInt*) T0)[0] = 200088;
--+         T1[0] = (FiWord) "/";
--+         ((FiSInt*) T0)[1] = 770345191;
--+         T1[1] = (FiWord) "coerce";
--+         ((FiSInt*) T0)[2] = 200102;
--+         T1[2] = (FiWord) "=";
--+         ((FiSInt*) T0)[3] = 200089;
--+         T1[3] = (FiWord) "0";
--+         ((FiSInt*) T0)[4] = 51509389;
--+         T1[4] = (FiWord) "~=";
--+         ((FiSInt*) T0)[5] = 316169058;
--+         T1[5] = (FiWord) "Rep";
--+         ((FiSInt*) T0)[6] = 200083;
--+         T1[6] = (FiWord) "*";
--+         ((FiSInt*) T0)[7] = 200090;
--+         T1[7] = (FiWord) "1";
--+         ((FiSInt*) T0)[8] = 477900237;
--+         T1[8] = (FiWord) "integer";
--+         ((FiSInt*) T0)[9] = 200084;
--+         T1[9] = (FiWord) "+";
--+         ((FiSInt*) T0)[10] = 206475020;
--+         T1[10] = (FiWord) "zero?";
--+         ((FiSInt*) T0)[11] = 200135;
--+         T1[11] = (FiWord) "^";
--+         ((FiSInt*) T0)[12] = 318722696;
--+         T1[12] = (FiWord) "inv";
--+         ((FiSInt*) T0)[13] = 683165523;
--+         T1[13] = (FiWord) "lift";
--+         ((FiSInt*) T0)[14] = 200086;
--+         T1[14] = (FiWord) "-";
--+         ((FiSInt*) T0)[15] = 51492426;
--+         T1[15] = (FiWord) "<<";
--+         T2 = fiNew(struct Fmt7 );
--+         T2->X0_size = 16;
--+         T2->X1_nsize = 16;
--+         T2->X2_values = (FiWord) T0;
--+         T3 = fiNew(struct Fmt7 );
--+         T3->X0_size = 16;
--+         T3->X1_nsize = 16;
--+         T3->X2_values = (FiWord) T1;
--+         fiCCall2(void, (*pG_822GM_rtAddStrings), (FiWord) T2, (FiWord) T3);
--+         fiCCall0(void, (*pG_P63GL_boolean));
--+         fiCCall0(void, (*pG_BXNX_outport));
--+         fiCCall0(void, (*pG_OGNYK_string));
--+         fiCCall0(void, (*pG_NO017_basic));
--+         l0->X4 = (FiWord) fiNil;
--+         fiCCall0(void, (*pG_OPE1D_ascat));
--+         l0->X0_Ring = (FiWord) (*pG_WWV15_ascat__Ring__10110696);
--+         fiCCall0(void, (*pG_HAQ5R_sinteger));
--+         l0->X1_SingleInteger = (FiWord) (*pG_7PJN6_sinteger__SingleInteg);
--+         fiCCall0(void, (*pG_WJ27Y_integer));
--+         l0->X3_Integer = (FiWord) (*pG_VJ6DK_integer__Integer__615);
--+         fiCCall0(void, (*pG_FKD29_bpower));
--+         l0->X2_BinaryPowering = (FiClos) (*
--+         	pG_2LA6D_bpower__BinaryPowerin);
--+         fiCCall0(void, (*pG_JNB1W_machine));
--+         fiProgHashCode(fiClosMake(e0, C17_SmallIntegerMod)->prog) =
--+         	665063438;
--+         l0->X5 = (FiWord) fiNil;
--+         fiProgHashCode(fiClosMake(e0, C30_IntegerMod)->prog) = 164204040;
--+         return ;
--+ }
--+
--+ static struct _FiProg  tmp0_imod = {
--+         (FiFun) CF0_imod,
--+         0,
--+         0,
--+         0
--+ };
--+
--+ static struct _FiClos  tmpClos0_imod = {
--+         0,
--+         (FiProg) &tmp0_imod
--+ };
--+ FiClos G_OCS69_imod = &tmpClos0_imod;
--+
--+
--+ static FiClos
--+ CF1_IntegerModRep(e1, P0_I)
--+         FiEnv e1;
--+         FiWord P0_I;
--+ {
--+         FiSInt T0;
--+         PFmt10 l0;
--+         FiEnv e0;
--+         l0 = fiNew(struct Fmt10 );
--+         e0 = fiEnvPush(l0, e1);
--+         l0->X0_I = P0_I;
--+         l0->X1 = (FiWord) fiNil;
--+         l0->X14_dom = l0->X0_I;
--+         l0->X13_mod = CF48_lazyFnGetter(e1, l0->X14_dom, 318461307, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X2__EQ_ = CF48_lazyFnGetter(e1, l0->X14_dom, 200102, (
--+         	740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X3__TILDE__EQ_ = CF48_lazyFnGetter(e1, l0->X14_dom,
--+         	51509389, (740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X9__MINUS_ = CF48_lazyFnGetter(e1, l0->X14_dom, 200086, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X7__PLUS_ = CF48_lazyFnGetter(e1, l0->X14_dom, 200084, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         T0 = fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I);
--+         l0->X6_0 = fiCCall3(FiWord, (*pG_4NZQI_lazyGetExport_BANG_),
--+         	l0->X14_dom, 200089, T0);
--+         l0->X5__LT_ = CF48_lazyFnGetter(e1, l0->X14_dom, 200101, (
--+         	740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X4__LT__LT_ = CF48_lazyFnGetter(e1, l0->X14_dom, 51492426, (
--+         	968858812 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), l0->X0_I) + 175832832) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         l0->X8_zero_QMARK_ = CF46_lazyFnGetter(e1, l0->X14_dom,
--+         	206475020, (740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), l0->X0_I) + 74075968) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         l0->X12_quo = CF48_lazyFnGetter(e1, l0->X14_dom, 318204816, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X11__STAR_ = CF48_lazyFnGetter(e1, l0->X14_dom, 200083, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I) +
--+         	74075968) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         T0 = fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l0->X0_I);
--+         l0->X10_1 = fiCCall3(FiWord, (*pG_4NZQI_lazyGetExport_BANG_),
--+         	l0->X14_dom, 200090, T0);
--+         fiProgHashCode(fiClosMake(e0, C2_IntegerModRep)->prog) =
--+         	377871722;
--+         return fiClosMake(e0, C2_IntegerModRep);
--+ }
--+
--+ static struct _FiProg  tmp1_IntegerModRep = {
--+         (FiFun) CF1_IntegerModRep,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF2_IntegerModRep(e1, P0_n)
--+         FiEnv e1;
--+         FiWord P0_n;
--+ {
--+         FiBool T4;
--+         FiWord *T0, T2, T3;
--+         PFmt5 T1;
--+         PFmt9 l0;
--+         FiEnv e0;
--+         PFmt10 l1;
--+         l0 = fiNew(struct Fmt9 );
--+         e0 = fiEnvPush(l0, e1);
--+         l1 = (PFmt10) fiEnvLevel(e1);
--+         l0->X0_n = P0_n;
--+         fiARRNEW_Word(T0, FiWord*, 1);
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 1;
--+         T1->X1_values = (FiWord) T0;
--+         fiPTR_IS_NIL(T4, FiBool, (FiPtr) l1->X1);
--+         if (!T4) goto L1;
--+         l1->X1 = fiCCall0(FiWord, (*pG_QQHP2_rtCacheMake));
--+ L1:	T0[0] = l0->X0_n;
--+         fiCFun(FiWord, (*pG_759EG_rtCacheCheck))(((*pG_759EG_rtCacheCheck))->
--+         	env, l1->X1, (FiWord) T1, &T2, &T3);
--+         if (T3) goto L0;
--+         T2 = fiCCall1(FiWord, (*pG_6L1ZC_domainMake), fiClosMake(e0,
--+         	C3_addLevel0));
--+         fiCCall3(FiWord, (*pG_PV28S_rtCacheAdd), l1->X1, (FiWord) T1, T2);
--+ L0:	return T2;
--+ }
--+
--+ static struct _FiProg  tmp2_IntegerModRep = {
--+         (FiFun) CF2_IntegerModRep,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiClos
--+ CF3_addLevel0(e1, P0_domain)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+ {
--+         FiSInt T0;
--+         PFmt10 l2;
--+         FiEnv e0, e2;
--+         e0 = fiEnvPush(fiNil, e1);
--+         e2 = fiEnvNext(e1);
--+         l2 = (PFmt10) fiEnvLevel(e2);
--+         fiCCall2(FiWord, (*pG_CSVBL_domainAddNameFn_BANG_), P0_domain,
--+         	fiClosMake(e0, C4_addNameFn));
--+         T0 = fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l2->X0_I);
--+         fiCCall2(FiWord, (*pG_XS55O_domainAddHash_BANG_), P0_domain, (7 + (((
--+         	T0 + 561470080) % 1073741789 & 16777215) << 6)) % 1073741789);
--+         return fiClosMake(e0, C5_addLevel1);
--+ }
--+
--+ static struct _FiProg  tmp3_addLevel0 = {
--+         (FiFun) CF3_addLevel0,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF4_addNameFn(e1)
--+         FiEnv e1;
--+ {
--+         PFmt5 T1, T3, T5, T7;
--+         FiWord *T0, *T2, *T4, *T6;
--+         FiEnv e3, e2;
--+         PFmt10 l3;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt10) fiEnvLevel(e3);
--+         fiARRNEW_Word(T0, FiWord*, 3);
--+         T0[0] = (FiWord) "(";
--+         T0[1] = fiCCall1(FiWord, (*pG_GJ87F_domainName), l3->X0_I);
--+         T0[2] = (FiWord) ")";
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 3;
--+         T1->X1_values = (FiWord) T0;
--+         fiARRNEW_Word(T2, FiWord*, 2);
--+         T2[0] = (FiWord) "IntegerModRep";
--+         T2[1] = fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T1);
--+         T3 = fiNew(struct Fmt5 );
--+         T3->X0_size = 2;
--+         T3->X1_values = (FiWord) T2;
--+         fiARRNEW_Word(T4, FiWord*, 3);
--+         T4[0] = (FiWord) "(";
--+         T4[1] = (FiWord) "n==<value>";
--+         T4[2] = (FiWord) ")";
--+         T5 = fiNew(struct Fmt5 );
--+         T5->X0_size = 3;
--+         T5->X1_values = (FiWord) T4;
--+         fiARRNEW_Word(T6, FiWord*, 2);
--+         T6[0] = fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T3);
--+         T6[1] = fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T5);
--+         T7 = fiNew(struct Fmt5 );
--+         T7->X0_size = 2;
--+         T7->X1_values = (FiWord) T6;
--+         return fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T7);
--+ }
--+
--+ static struct _FiProg  tmp4_addNameFn = {
--+         (FiFun) CF4_addNameFn,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF5_addLevel1(e1, P0_domain, P1_hashcode)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+         FiWord P1_hashcode;
--+ {
--+         FiSInt *T0, *T1, T6, T7, T8, T9, T10, T11, T12, T13, T14,
--+         	T15, T16;
--+         PFmt7 T3, T4, T5;
--+         FiWord *T2;
--+         PFmt8 l0;
--+         FiEnv e4, e3, e2, e0;
--+         PFmt10 l3;
--+         PFmt19 l4;
--+         l0 = fiNew(struct Fmt8 );
--+         e0 = fiEnvPush(l0, e1);
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt10) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         fiARRNEW_SInt(T0, FiSInt*, 13);
--+         fiARRNEW_SInt(T1, FiSInt*, 13);
--+         fiARRNEW_Word(T2, FiWord*, 13);
--+         l0->X10_coerce = fiClosMake(e0, C6_coerce);
--+         l0->X9_zero_QMARK_ = fiClosMake(e0, C7_zero_QMARK_);
--+         l0->X8__EQ_ = fiClosMake(e0, C8__EQ_);
--+         l0->X7__TILDE__EQ_ = fiClosMake(e0, C9__TILDE__EQ_);
--+         l0->X5__PLUS_ = fiClosMake(e0, C10__PLUS_);
--+         l0->X3__MINUS_ = fiClosMake(e0, C11__MINUS_);
--+         l0->X6__PLUS_ = fiClosMake(e0, C12__PLUS_);
--+         l0->X4__MINUS_ = fiClosMake(e0, C13__MINUS_);
--+         l0->X2_lift = fiClosMake(e0, C14_lift);
--+         l0->X1__LT__LT_ = fiClosMake(e0, C15__LT__LT_);
--+         l0->X0_inv = fiClosMake(e0, C16_inv);
--+         T3 = fiNew(struct Fmt7 );
--+         T3->X0_size = 13;
--+         T3->X1_nsize = 13;
--+         T3->X2_values = (FiWord) T0;
--+         T4 = fiNew(struct Fmt7 );
--+         T4->X0_size = 13;
--+         T4->X1_nsize = 13;
--+         T4->X2_values = (FiWord) T1;
--+         T5 = fiNew(struct Fmt7 );
--+         T5->X0_size = 13;
--+         T5->X1_nsize = 13;
--+         T5->X2_values = (FiWord) T2;
--+         fiCCall4(void, (*pG_PA5R2_domainAddExports), P0_domain, (FiWord) T3, (
--+         	FiWord) T4, (FiWord) T5);
--+         l0->X13 = (FiSInt) P1_hashcode;
--+         T0[0] = 770345191;
--+         T1[0] = (l0->X13 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), l3->X0_I) + 74075968) %
--+         	1073741789 & 16777215) << 6)) % 1073741789;
--+         T2[0] = (FiWord) l0->X10_coerce;
--+         T0[1] = 206475020;
--+         T6 = (l0->X13 + 74075968) % 1073741789;
--+         T7 = T6 & 16777215;
--+         T8 = T7 << 6;
--+         T1[1] = (740244383 + T8) % 1073741789;
--+         T2[1] = (FiWord) l0->X9_zero_QMARK_;
--+         T0[2] = 200102;
--+         T9 = (l0->X13 + T8) % 1073741789;
--+         T10 = T9 & 16777215;
--+         T11 = T10 << 6;
--+         T12 = (740244383 + T11) % 1073741789;
--+         T1[2] = T12;
--+         T2[2] = (FiWord) l0->X8__EQ_;
--+         T0[3] = 51509389;
--+         T1[3] = T12;
--+         T2[3] = (FiWord) l0->X7__TILDE__EQ_;
--+         T0[4] = 200084;
--+         T1[4] = T9;
--+         T2[4] = (FiWord) l0->X5__PLUS_;
--+         T0[5] = 200086;
--+         T1[5] = T9;
--+         T2[5] = (FiWord) l0->X3__MINUS_;
--+         T0[6] = 200084;
--+         T13 = (l0->X13 + T11) % 1073741789;
--+         T1[6] = T13;
--+         T2[6] = (FiWord) l0->X6__PLUS_;
--+         T0[7] = 200086;
--+         T1[7] = T13;
--+         T2[7] = (FiWord) l0->X4__MINUS_;
--+         T0[8] = 683165523;
--+         T14 = (l0->X13 + 74075968) % 1073741789;
--+         T15 = T14 & 16777215;
--+         T16 = T15 << 6;
--+         T1[8] = (fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), l3->
--+         	X0_I) + T16) % 1073741789;
--+         T2[8] = (FiWord) l0->X2_lift;
--+         T0[9] = 51492426;
--+         T1[9] = (968858812 + (((l0->X13 + 175832832) %
--+         	1073741789 & 16777215) << 6)) % 1073741789;
--+         T2[9] = (FiWord) l0->X1__LT__LT_;
--+         T0[10] = 318722696;
--+         T1[10] = (l0->X13 + T16) % 1073741789;
--+         T2[10] = (FiWord) l0->X0_inv;
--+         l0->X12_0 = fiCCall1(FiWord, (*pG_R3D1K_lazyForceImport), l3->
--+         	X6_0);
--+         T0[11] = 200089;
--+         T1[11] = l0->X13;
--+         T2[11] = l0->X12_0;
--+         l0->X11_1 = fiCCall1(FiWord, (*pG_R3D1K_lazyForceImport), l3->
--+         	X10_1);
--+         T0[12] = 200090;
--+         T1[12] = l0->X13;
--+         T2[12] = l0->X11_1;
--+         return P0_domain;
--+ }
--+
--+ static struct _FiProg  tmp5_addLevel1 = {
--+         (FiFun) CF5_addLevel1,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF6_coerce(e1, P0_i)
--+         FiEnv e1;
--+         FiWord P0_i;
--+ {
--+         FiEnv e4, e3, e2;
--+         PFmt9 l3;
--+         PFmt10 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt9) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         return fiCCall2(FiWord, l4->X13_mod, P0_i, l3->X0_n);
--+ }
--+
--+ static struct _FiProg  tmp6_coerce = {
--+         (FiFun) CF6_coerce,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF7_zero_QMARK_(e1, P0_x)
--+         FiEnv e1;
--+         FiWord P0_x;
--+ {
--+         PFmt8 l1;
--+         FiEnv e4, e3, e2;
--+         PFmt10 l4;
--+         l1 = (PFmt8) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         return fiCCall2(FiWord, l4->X2__EQ_, P0_x, l1->X12_0);
--+ }
--+
--+ static struct _FiProg  tmp7_zero_QMARK_ = {
--+         (FiFun) CF7_zero_QMARK_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF8__EQ_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         FiEnv e4, e3, e2;
--+         PFmt10 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         return fiCCall2(FiWord, l4->X2__EQ_, P0_x, P1_y);
--+ }
--+
--+ static struct _FiProg  tmp8__EQ_ = {
--+         (FiFun) CF8__EQ_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF9__TILDE__EQ_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         FiEnv e4, e3, e2;
--+         PFmt10 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         return fiCCall2(FiWord, l4->X3__TILDE__EQ_, P0_x, P1_y);
--+ }
--+
--+ static struct _FiProg  tmp9__TILDE__EQ_ = {
--+         (FiFun) CF9__TILDE__EQ_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF10__PLUS_(e1, P0_x)
--+         FiEnv e1;
--+         FiWord P0_x;
--+ {
--+         return P0_x;
--+ }
--+
--+ static struct _FiProg  tmp10__PLUS_ = {
--+         (FiFun) CF10__PLUS_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF11__MINUS_(e1, P0_x)
--+         FiEnv e1;
--+         FiWord P0_x;
--+ {
--+         FiWord T0;
--+         PFmt8 l1;
--+         FiEnv e4, e3, e2;
--+         PFmt9 l3;
--+         PFmt10 l4;
--+         l1 = (PFmt8) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt9) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         if ((FiBool) fiCCall2(FiWord, l4->X2__EQ_, P0_x, l1->X12_0)) goto
--+         	L0;
--+         T0 = fiCCall2(FiWord, l4->X9__MINUS_, l3->X0_n, P0_x);
--+ L1:	return T0;
--+ L0:	T0 = l1->X12_0;
--+         goto L1;
--+ }
--+
--+ static struct _FiProg  tmp11__MINUS_ = {
--+         (FiFun) CF11__MINUS_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF12__PLUS_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         FiWord T0_z, T1, T2;
--+         FiEnv e4, e3, e2;
--+         PFmt9 l3;
--+         PFmt10 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt9) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         T2 = fiCCall2(FiWord, l4->X9__MINUS_, P0_x, l3->X0_n);
--+         T0_z = fiCCall2(FiWord, l4->X7__PLUS_, T2, P1_y);
--+         T2 = fiCCall1(FiWord, (*pG_R3D1K_lazyForceImport), l4->X6_0);
--+         if ((FiBool) fiCCall2(FiWord, l4->X5__LT_, T0_z, T2)) goto L0;
--+         T1 = T0_z;
--+ L1:	return T1;
--+ L0:	T1 = fiCCall2(FiWord, l4->X7__PLUS_, T0_z, l3->X0_n);
--+         goto L1;
--+ }
--+
--+ static struct _FiProg  tmp12__PLUS_ = {
--+         (FiFun) CF12__PLUS_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF13__MINUS_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         FiWord T0_z, T1, T2;
--+         FiEnv e4, e3, e2;
--+         PFmt9 l3;
--+         PFmt10 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt9) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         T0_z = fiCCall2(FiWord, l4->X9__MINUS_, P0_x, P1_y);
--+         T2 = fiCCall1(FiWord, (*pG_R3D1K_lazyForceImport), l4->X6_0);
--+         if ((FiBool) fiCCall2(FiWord, l4->X5__LT_, T0_z, T2)) goto L0;
--+         T1 = T0_z;
--+ L1:	return T1;
--+ L0:	T1 = fiCCall2(FiWord, l4->X7__PLUS_, T0_z, l3->X0_n);
--+         goto L1;
--+ }
--+
--+ static struct _FiProg  tmp13__MINUS_ = {
--+         (FiFun) CF13__MINUS_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF14_lift(e1, P0_x)
--+         FiEnv e1;
--+         FiWord P0_x;
--+ {
--+         return P0_x;
--+ }
--+
--+ static struct _FiProg  tmp14_lift = {
--+         (FiFun) CF14_lift,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF15__LT__LT_(e1, P0_port, P1_x)
--+         FiEnv e1;
--+         FiWord P0_port;
--+         FiWord P1_x;
--+ {
--+         FiEnv e4, e3, e2;
--+         PFmt10 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         return fiCCall2(FiWord, l4->X4__LT__LT_, P0_port, P1_x);
--+ }
--+
--+ static struct _FiProg  tmp15__LT__LT_ = {
--+         (FiFun) CF15__LT__LT_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF16_inv(e1, P0_j)
--+         FiEnv e1;
--+         FiWord P0_j;
--+ {
--+         FiWord T0_q, T1_d1, T2_c1, T3_d0, T4_c0, T5, T6, T7;
--+         PFmt8 l1;
--+         FiEnv e5, e4, e3, e2;
--+         PFmt9 l3;
--+         PFmt10 l4;
--+         PFmt19 l5;
--+         l1 = (PFmt8) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt9) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt10) fiEnvLevel(e4);
--+         e5 = fiEnvNext(e4);
--+         l5 = (PFmt19) fiEnvLevel(e5);
--+         T5 = P0_j;
--+         T6 = l3->X0_n;
--+         T4_c0 = P0_j;
--+         T3_d0 = T6;
--+         T6 = l1->X11_1;
--+         T5 = fiCCall1(FiWord, (*pG_R3D1K_lazyForceImport), l4->X6_0);
--+         T2_c1 = T6;
--+         T1_d1 = T5;
--+ L0:	if ((FiBool) fiCCall1(FiWord, l4->X8_zero_QMARK_, T3_d0)) goto L1;
--+         T0_q = fiCCall2(FiWord, l4->X12_quo, T4_c0, T3_d0);
--+         T5 = T3_d0;
--+         T7 = fiCCall2(FiWord, l4->X11__STAR_, T0_q, T3_d0);
--+         T6 = fiCCall2(FiWord, l4->X9__MINUS_, T4_c0, T7);
--+         T4_c0 = T3_d0;
--+         T3_d0 = T6;
--+         T6 = T1_d1;
--+         T7 = fiCCall2(FiWord, l4->X11__STAR_, T0_q, T1_d1);
--+         T5 = fiCCall2(FiWord, l4->X9__MINUS_, T2_c1, T7);
--+         T2_c1 = T1_d1;
--+         T1_d1 = T5;
--+         goto L0;
--+ L1:	T7 = fiCCall1(FiWord, (*pG_R3D1K_lazyForceImport), l4->X10_1);
--+         if ((FiBool) fiCCall2(FiWord, l4->X3__TILDE__EQ_, T4_c0, T7)) goto
--+         	L2;
--+ L3:	T7 = fiCCall1(FiWord, (*pG_R3D1K_lazyForceImport), l4->X6_0);
--+         if ((FiBool) fiCCall2(FiWord, l4->X5__LT_, T2_c1, T7)) goto L4;
--+ L5:	return T2_c1;
--+ L4:	T2_c1 = fiCCall2(FiWord, l4->X7__PLUS_, T2_c1, l3->X0_n);
--+         goto L5;
--+ L2:	fputs("inverse does not exist", stdoutFile());
--+         fputc((FiWord) 10, stdoutFile());
--+         fiHalt(0);
--+         goto L3;
--+ }
--+
--+ static struct _FiProg  tmp16_inv = {
--+         (FiFun) CF16_inv,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF17_SmallIntegerMod(e1, P0_n)
--+         FiEnv e1;
--+         FiWord P0_n;
--+ {
--+         FiBool T4;
--+         FiWord *T0, T2, T3;
--+         PFmt5 T1;
--+         PFmt14 l0;
--+         FiEnv e0;
--+         PFmt19 l1;
--+         l0 = fiNew(struct Fmt14 );
--+         e0 = fiEnvPush(l0, e1);
--+         l1 = (PFmt19) fiEnvLevel(e1);
--+         l0->X0_n = P0_n;
--+         fiARRNEW_Word(T0, FiWord*, 1);
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 1;
--+         T1->X1_values = (FiWord) T0;
--+         fiPTR_IS_NIL(T4, FiBool, (FiPtr) l1->X4);
--+         if (!T4) goto L1;
--+         l1->X4 = fiCCall0(FiWord, (*pG_QQHP2_rtCacheMake));
--+ L1:	T0[0] = l0->X0_n;
--+         fiCFun(FiWord, (*pG_759EG_rtCacheCheck))(((*pG_759EG_rtCacheCheck))->
--+         	env, l1->X4, (FiWord) T1, &T2, &T3);
--+         if (T3) goto L0;
--+         T2 = fiCCall1(FiWord, (*pG_6L1ZC_domainMake), fiClosMake(e0,
--+         	C18_addLevel0));
--+         fiCCall3(FiWord, (*pG_PV28S_rtCacheAdd), l1->X4, (FiWord) T1, T2);
--+ L0:	return T2;
--+ }
--+
--+ static struct _FiProg  tmp17_SmallIntegerMod = {
--+         (FiFun) CF17_SmallIntegerMod,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiClos
--+ CF18_addLevel0(e1, P0_domain)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+ {
--+         FiEnv e0;
--+         e0 = fiEnvPush(fiNil, e1);
--+         fiCCall2(FiWord, (*pG_CSVBL_domainAddNameFn_BANG_), P0_domain,
--+         	fiClosMake(e0, C19_addNameFn));
--+         fiCCall2(FiWord, (*pG_XS55O_domainAddHash_BANG_), P0_domain,
--+         	688128903);
--+         return fiClosMake(e0, C20_addLevel1);
--+ }
--+
--+ static struct _FiProg  tmp18_addLevel0 = {
--+         (FiFun) CF18_addLevel0,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF19_addNameFn(e1)
--+         FiEnv e1;
--+ {
--+         PFmt5 T1, T3;
--+         FiWord *T0, *T2;
--+         fiARRNEW_Word(T0, FiWord*, 3);
--+         T0[0] = (FiWord) "(";
--+         T0[1] = (FiWord) "n==<value>";
--+         T0[2] = (FiWord) ")";
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 3;
--+         T1->X1_values = (FiWord) T0;
--+         fiARRNEW_Word(T2, FiWord*, 2);
--+         T2[0] = (FiWord) "SmallIntegerMod";
--+         T2[1] = fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T1);
--+         T3 = fiNew(struct Fmt5 );
--+         T3->X0_size = 2;
--+         T3->X1_values = (FiWord) T2;
--+         return fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T3);
--+ }
--+
--+ static struct _FiProg  tmp19_addNameFn = {
--+         (FiFun) CF19_addNameFn,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF20_addLevel1(e1, P0_domain, P1_hashcode)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+         FiWord P1_hashcode;
--+ {
--+         FiSInt *T0, *T1, T12, T13, T14, T15, T16, T17, T18, T20;
--+         FiClos T8, T19;
--+         FiEnv e3, e2, e0, T11;
--+         FiWord *T2, T6, *T7, T10;
--+         PFmt7 T3, T4, T5, T9;
--+         PFmt13 l0;
--+         PFmt14 l2;
--+         PFmt19 l3;
--+         l0 = fiNew(struct Fmt13 );
--+         e0 = fiEnvPush(l0, e1);
--+         e2 = fiEnvNext(e1);
--+         l2 = (PFmt14) fiEnvLevel(e2);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt19) fiEnvLevel(e3);
--+         fiARRNEW_SInt(T0, FiSInt*, 7);
--+         fiARRNEW_SInt(T1, FiSInt*, 7);
--+         fiARRNEW_Word(T2, FiWord*, 7);
--+         l0->X4_coerce = fiClosMake(e0, C24_coerce);
--+         l0->X5_coerce = fiClosMake(e0, C25_coerce);
--+         l0->X3_integer = fiClosMake(e0, C26_integer);
--+         l0->X2__HAT_ = fiClosMake(e0, C27__HAT_);
--+         l0->X1__SLASH_ = fiClosMake(e0, C28__SLASH_);
--+         l0->X0__STAR_ = fiClosMake(e0, C29__STAR_);
--+         T3 = fiNew(struct Fmt7 );
--+         T3->X0_size = 7;
--+         T3->X1_nsize = 7;
--+         T3->X2_values = (FiWord) T0;
--+         T4 = fiNew(struct Fmt7 );
--+         T4->X0_size = 7;
--+         T4->X1_nsize = 7;
--+         T4->X2_values = (FiWord) T1;
--+         T5 = fiNew(struct Fmt7 );
--+         T5->X0_size = 7;
--+         T5->X1_nsize = 7;
--+         T5->X2_values = (FiWord) T2;
--+         fiCCall4(void, (*pG_PA5R2_domainAddExports), P0_domain, (FiWord) T3, (
--+         	FiWord) T4, (FiWord) T5);
--+         T6 = fiCCall1(FiWord, (*pG_IJHFC_domainMakeDispatch), P0_domain);
--+         l0->X7__PCENT_ = T6;
--+         l0->X10 = (FiSInt) P1_hashcode;
--+         T19 = fiCCall2(FiClos, (*pG_GOVLL_categoryMake), fiClosMake(e0,
--+         	C22_SmallIntegerMod), fiClosMake(e0, C21_defhash0));
--+         fiCCall3(FiWord, (*pG_V9SO_domainAddDefaults), P0_domain, T19, T6);
--+         fiARRNEW_Word(T7, FiWord*, 1);
--+         T11 = fiEnvPush(fiNew(struct Fmt10 ), e3);
--+         ((PFmt10) fiEnvLevel0(T11))->X0_I = l3->X1_SingleInteger;
--+         ((PFmt10) fiEnvLevel0(T11))->X1 = (FiWord) fiNil;
--+         ((PFmt10) fiEnvLevel0(T11))->X14_dom = ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I;
--+         ((PFmt10) fiEnvLevel0(T11))->X13_mod = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 318461307, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X2__EQ_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200102, (740244383 + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X3__TILDE__EQ_ = CF48_lazyFnGetter(
--+         	e3, ((PFmt10) fiEnvLevel0(T11))->X14_dom, 51509389, (
--+         	740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X9__MINUS_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200086, (fiCCall1(
--+         	FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X7__PLUS_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200084, (fiCCall1(
--+         	FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         T20 = fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I);
--+         ((PFmt10) fiEnvLevel0(T11))->X6_0 = fiCCall3(FiWord, (*
--+         	pG_4NZQI_lazyGetExport_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X14_dom, 200089, T20);
--+         ((PFmt10) fiEnvLevel0(T11))->X5__LT_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200101, (740244383 + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X4__LT__LT_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 51492426, (
--+         	968858812 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 175832832) % 1073741789 & 16777215) << 6)) %
--+         	1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X8_zero_QMARK_ = CF46_lazyFnGetter(
--+         	e3, ((PFmt10) fiEnvLevel0(T11))->X14_dom, 206475020, (
--+         	740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X12_quo = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 318204816, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X11__STAR_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200083, (fiCCall1(
--+         	FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         T20 = fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I);
--+         ((PFmt10) fiEnvLevel0(T11))->X10_1 = fiCCall3(FiWord, (*
--+         	pG_4NZQI_lazyGetExport_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X14_dom, 200090, T20);
--+         fiProgHashCode(fiClosMake(T11, C2_IntegerModRep)->prog) =
--+         	377871722;
--+         T8 = fiClosMake(T11, C2_IntegerModRep);
--+         T7[0] = fiCCall1(FiWord, T8, l2->X0_n);
--+         T9 = fiNew(struct Fmt7 );
--+         T9->X0_size = 1;
--+         T9->X1_nsize = 1;
--+         T9->X2_values = (FiWord) T7;
--+         fiCCall3(FiWord, (*pG_LKD03_domainAddParents), P0_domain, (FiWord) T9,
--+         	T6);
--+         T0[0] = 770345191;
--+         T1[0] = (l0->X10 + 974156096) % 1073741789;
--+         T2[0] = (FiWord) l0->X4_coerce;
--+         T0[1] = 770345191;
--+         T1[1] = (l0->X10 + 296696640) % 1073741789;
--+         T2[1] = (FiWord) l0->X5_coerce;
--+         T0[2] = 477900237;
--+         T1[2] = (l0->X10 + 332724992) % 1073741789;
--+         T2[2] = (FiWord) l0->X3_integer;
--+         l0->X12_dom = fiCCall3(FiWord, l3->X2_BinaryPowering, l0->
--+         	X7__PCENT_, l0->X0__STAR_, l3->X3_Integer);
--+         l0->X11_power = CF44_lazyFnGetter(e3, l0->X12_dom, 1046982458, (
--+         	l0->X10 + (((484208045 + (((l0->
--+         	X10 + (((l0->X10 + 74075968) % 1073741789 &
--+         	16777215) << 6)) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         T0[3] = 200135;
--+         T12 = (l0->X10 + 74075968) % 1073741789;
--+         T13 = T12 & 16777215;
--+         T14 = T13 << 6;
--+         T1[3] = (l0->X10 + (((484208045 + T14) %
--+         	1073741789 & 16777215) << 6)) % 1073741789;
--+         T2[3] = (FiWord) l0->X2__HAT_;
--+         T0[4] = 200088;
--+         T15 = (l0->X10 + T14) % 1073741789;
--+         T16 = T15 & 16777215;
--+         T17 = T16 << 6;
--+         T18 = (l0->X10 + T17) % 1073741789;
--+         T1[4] = T18;
--+         T2[4] = (FiWord) l0->X1__SLASH_;
--+         T0[5] = 200083;
--+         T1[5] = T18;
--+         T2[5] = (FiWord) l0->X0__STAR_;
--+         l0->X6_Rep = fiCCall0(FiWord, (*pG_BEY7_domainMakeDummy));
--+         T10 = l0->X6_Rep;
--+         l0->X6_Rep = l3->X1_SingleInteger;
--+         fiCCall2(void, (*pG_AK1EB_domainFill_BANG_), T10, l0->X6_Rep);
--+         l0->X6_Rep = T10;
--+         T0[6] = 316169058;
--+         T1[6] = 850925108;
--+         T2[6] = l0->X6_Rep;
--+         l0->X8_inv = (FiClos) fiCCall3(FiWord, (*
--+         	pG_1X2RM_domainGetExport_BANG_), T6, 318722696, (l0->
--+         	X10 + (((l0->X10 + 74075968) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X9_1 = fiCCall3(FiWord, (*pG_1X2RM_domainGetExport_BANG_),
--+         	T6, 200090, l0->X10);
--+         return P0_domain;
--+ }
--+
--+ static struct _FiProg  tmp20_addLevel1 = {
--+         (FiFun) CF20_addLevel1,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiSInt
--+ CF21_defhash0(e1)
--+         FiEnv e1;
--+ {
--+         PFmt13 l1;
--+         l1 = (PFmt13) fiEnvLevel(e1);
--+         return 688128903;
--+ }
--+
--+ static struct _FiProg  tmp21_defhash0 = {
--+         (FiFun) CF21_defhash0,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static void
--+ CF22_SmallIntegerMod(e1, P0_self, P1_dom)
--+         FiEnv e1;
--+         FiWord P0_self;
--+         FiWord P1_dom;
--+ {
--+         PFmt7 T3, T4, T5, T7;
--+         FiWord *T2, *T6;
--+         FiSInt *T0, *T1;
--+         PFmt11 l0;
--+         FiEnv e4, e3, e2, e0;
--+         PFmt19 l4;
--+         l0 = fiNew(struct Fmt11 );
--+         e0 = fiEnvPush(l0, e1);
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         fiARRNEW_SInt(T0, FiSInt*, 0);
--+         fiARRNEW_SInt(T1, FiSInt*, 0);
--+         fiARRNEW_Word(T2, FiWord*, 0);
--+         l0->X0__PCENT_ = P1_dom;
--+         T3 = fiNew(struct Fmt7 );
--+         T3->X0_size = 0;
--+         T3->X1_nsize = 0;
--+         T3->X2_values = (FiWord) T0;
--+         T4 = fiNew(struct Fmt7 );
--+         T4->X0_size = 0;
--+         T4->X1_nsize = 0;
--+         T4->X2_values = (FiWord) T1;
--+         T5 = fiNew(struct Fmt7 );
--+         T5->X0_size = 0;
--+         T5->X1_nsize = 0;
--+         T5->X2_values = (FiWord) T2;
--+         fiCCall4(void, (*pG_WXLY5_categoryAddExports), P0_self, (FiWord) T3, (
--+         	FiWord) T4, (FiWord) T5);
--+         fiCCall2(FiWord, (*pG_6M45D_categoryAddNameFn), P0_self, fiClosMake(
--+         	e0, C23_addNameFn));
--+         fiARRNEW_Word(T6, FiWord*, 1);
--+         T6[0] = l4->X0_Ring;
--+         T7 = fiNew(struct Fmt7 );
--+         T7->X0_size = 1;
--+         T7->X1_nsize = 1;
--+         T7->X2_values = (FiWord) T6;
--+         fiCCall3(FiWord, (*pG_YXGL3_categoryAddParents), P0_self, (FiWord) T7,
--+         	l0->X0__PCENT_);
--+         return ;
--+ }
--+
--+ static struct _FiProg  tmp22_SmallIntegerMod = {
--+         (FiFun) CF22_SmallIntegerMod,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF23_addNameFn(e1)
--+         FiEnv e1;
--+ {
--+         PFmt5 T1, T3;
--+         FiWord *T0, *T2;
--+         PFmt11 l1;
--+         l1 = (PFmt11) fiEnvLevel(e1);
--+         fiARRNEW_Word(T0, FiWord*, 3);
--+         T0[0] = (FiWord) "(";
--+         T0[1] = (FiWord) "n==<value>";
--+         T0[2] = (FiWord) ")";
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 3;
--+         T1->X1_values = (FiWord) T0;
--+         fiARRNEW_Word(T2, FiWord*, 2);
--+         T2[0] = (FiWord) "SmallIntegerMod";
--+         T2[1] = fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T1);
--+         T3 = fiNew(struct Fmt5 );
--+         T3->X0_size = 2;
--+         T3->X1_values = (FiWord) T2;
--+         return fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T3);
--+ }
--+
--+ static struct _FiProg  tmp23_addNameFn = {
--+         (FiFun) CF23_addNameFn,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF24_coerce(e1, P0_i)
--+         FiEnv e1;
--+         FiWord P0_i;
--+ {
--+         FiWord T1;
--+         FiSInt T0;
--+         FiEnv e4, e3, e2;
--+         PFmt14 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt14) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         T1 = l3->X0_n;
--+         fiSINT_REM(T0, FiSInt, (FiSInt) P0_i, (FiSInt) T1);
--+         if ((FiSInt) P0_i < 0) goto L1;
--+ L0:	return (FiWord) T0;
--+ L1:	T0 = T0 + (FiSInt) T1;
--+         goto L0;
--+ }
--+
--+ static struct _FiProg  tmp24_coerce = {
--+         (FiFun) CF24_coerce,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF25_coerce(e1, P0_i)
--+         FiEnv e1;
--+         FiWord P0_i;
--+ {
--+         FiSInt T3;
--+         FiBool T2;
--+         FiBInt T0, T1;
--+         FiEnv e4, e3, e2;
--+         PFmt14 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt14) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         fiSINT_TO_BINT(T1, FiBInt, (FiSInt) l3->X0_n);
--+         fiBINT_REM(T0, FiBInt, (FiBInt) P0_i, T1);
--+         fiBINT_IS_NEG(T2, FiBool, T0);
--+         if (T2) goto L2;
--+ L1:	fiBINT_TO_SINT(T3, FiSInt, T0);
--+         return (FiWord) T3;
--+ L2:	fiBINT_PLUS(T0, FiBInt, T0, T1);
--+         goto L1;
--+ }
--+
--+ static struct _FiProg  tmp25_coerce = {
--+         (FiFun) CF25_coerce,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF26_integer(e1, P0_l)
--+         FiEnv e1;
--+         FiWord P0_l;
--+ {
--+         FiSInt T4;
--+         FiBool T3;
--+         FiBInt T0_i, T1, T2;
--+         FiEnv e4, e3, e2;
--+         PFmt14 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt14) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         fiARR_TO_BINT(T0_i, FiBInt, P0_l);
--+         fiSINT_TO_BINT(T2, FiBInt, (FiSInt) l3->X0_n);
--+         fiBINT_REM(T1, FiBInt, T0_i, T2);
--+         fiBINT_IS_NEG(T3, FiBool, T1);
--+         if (T3) goto L2;
--+ L1:	fiBINT_TO_SINT(T4, FiSInt, T1);
--+         return (FiWord) T4;
--+ L2:	fiBINT_PLUS(T1, FiBInt, T1, T2);
--+         goto L1;
--+ }
--+
--+ static struct _FiProg  tmp26_integer = {
--+         (FiFun) CF26_integer,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF27__HAT_(e1, P0_x, P1_k)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_k;
--+ {
--+         PFmt13 l1;
--+         l1 = (PFmt13) fiEnvLevel(e1);
--+         return fiCCall3(FiWord, l1->X11_power, l1->X9_1, P0_x, P1_k);
--+ }
--+
--+ static struct _FiProg  tmp27__HAT_ = {
--+         (FiFun) CF27__HAT_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF28__SLASH_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         PFmt13 l1;
--+         l1 = (PFmt13) fiEnvLevel(e1);
--+         return CF29__STAR_(e1, P0_x, fiCCall1(FiWord, l1->X8_inv, P1_y));
--+ }
--+
--+ static struct _FiProg  tmp28__SLASH_ = {
--+         (FiFun) CF28__SLASH_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF29__STAR_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         FiSInt T5, T7;
--+         FiWord T0, T1, T2, T3, T4, T6;
--+         FiEnv e4, e3, e2;
--+         PFmt14 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt14) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         T0 = P1_y;
--+         if ((FiSInt) l3->X0_n < 32767) goto L1;
--+         if (32767 <= (FiSInt) P0_x) goto L4;
--+         if (32767 <= (FiSInt) P1_y) goto L4;
--+ L1:	T7 = (FiSInt) P0_x * (FiSInt) P1_y;
--+         T6 = l3->X0_n;
--+         fiSINT_REM(T5, FiSInt, T7, (FiSInt) T6);
--+         if (T7 < 0) goto L3;
--+ L2:	T0 = (FiWord) T5;
--+ L0:	return T0;
--+ L3:	T5 = T5 + (FiSInt) T6;
--+         goto L2;
--+ L4:	fiWordTimesDouble(P0_x, P1_y, &T1, &T2);
--+         fiWordDivideDouble(T1, T2, l3->X0_n, &T3, &T4);
--+         T0 = T4;
--+         goto L0;
--+ }
--+
--+ static struct _FiProg  tmp29__STAR_ = {
--+         (FiFun) CF29__STAR_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF30_IntegerMod(e1, P0_n)
--+         FiEnv e1;
--+         FiWord P0_n;
--+ {
--+         FiBool T4;
--+         FiWord *T0, T2, T3;
--+         PFmt5 T1;
--+         PFmt17 l0;
--+         FiEnv e0;
--+         PFmt19 l1;
--+         l0 = fiNew(struct Fmt17 );
--+         e0 = fiEnvPush(l0, e1);
--+         l1 = (PFmt19) fiEnvLevel(e1);
--+         l0->X0_n = P0_n;
--+         fiARRNEW_Word(T0, FiWord*, 1);
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 1;
--+         T1->X1_values = (FiWord) T0;
--+         fiPTR_IS_NIL(T4, FiBool, (FiPtr) l1->X5);
--+         if (!T4) goto L1;
--+         l1->X5 = fiCCall0(FiWord, (*pG_QQHP2_rtCacheMake));
--+ L1:	T0[0] = l0->X0_n;
--+         fiCFun(FiWord, (*pG_759EG_rtCacheCheck))(((*pG_759EG_rtCacheCheck))->
--+         	env, l1->X5, (FiWord) T1, &T2, &T3);
--+         if (T3) goto L0;
--+         T2 = fiCCall1(FiWord, (*pG_6L1ZC_domainMake), fiClosMake(e0,
--+         	C31_addLevel0));
--+         fiCCall3(FiWord, (*pG_PV28S_rtCacheAdd), l1->X5, (FiWord) T1, T2);
--+ L0:	return T2;
--+ }
--+
--+ static struct _FiProg  tmp30_IntegerMod = {
--+         (FiFun) CF30_IntegerMod,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiClos
--+ CF31_addLevel0(e1, P0_domain)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+ {
--+         FiEnv e0;
--+         e0 = fiEnvPush(fiNil, e1);
--+         fiCCall2(FiWord, (*pG_CSVBL_domainAddNameFn_BANG_), P0_domain,
--+         	fiClosMake(e0, C32_addNameFn));
--+         fiCCall2(FiWord, (*pG_XS55O_domainAddHash_BANG_), P0_domain,
--+         	845382151);
--+         return fiClosMake(e0, C33_addLevel1);
--+ }
--+
--+ static struct _FiProg  tmp31_addLevel0 = {
--+         (FiFun) CF31_addLevel0,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF32_addNameFn(e1)
--+         FiEnv e1;
--+ {
--+         PFmt5 T1, T3;
--+         FiWord *T0, *T2;
--+         fiARRNEW_Word(T0, FiWord*, 3);
--+         T0[0] = (FiWord) "(";
--+         T0[1] = (FiWord) "n==<value>";
--+         T0[2] = (FiWord) ")";
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 3;
--+         T1->X1_values = (FiWord) T0;
--+         fiARRNEW_Word(T2, FiWord*, 2);
--+         T2[0] = (FiWord) "IntegerMod";
--+         T2[1] = fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T1);
--+         T3 = fiNew(struct Fmt5 );
--+         T3->X0_size = 2;
--+         T3->X1_values = (FiWord) T2;
--+         return fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T3);
--+ }
--+
--+ static struct _FiProg  tmp32_addNameFn = {
--+         (FiFun) CF32_addNameFn,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF33_addLevel1(e1, P0_domain, P1_hashcode)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+         FiWord P1_hashcode;
--+ {
--+         FiSInt *T0, *T1, T12, T13, T14, T16;
--+         FiClos T8, T15;
--+         FiEnv e3, e2, e0, T11;
--+         FiWord *T2, T6, *T7, T10;
--+         PFmt7 T3, T4, T5, T9;
--+         PFmt16 l0;
--+         PFmt17 l2;
--+         PFmt19 l3;
--+         l0 = fiNew(struct Fmt16 );
--+         e0 = fiEnvPush(l0, e1);
--+         e2 = fiEnvNext(e1);
--+         l2 = (PFmt17) fiEnvLevel(e2);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt19) fiEnvLevel(e3);
--+         fiARRNEW_SInt(T0, FiSInt*, 7);
--+         fiARRNEW_SInt(T1, FiSInt*, 7);
--+         fiARRNEW_Word(T2, FiWord*, 7);
--+         l0->X4_coerce = fiClosMake(e0, C37_coerce);
--+         l0->X5_coerce = fiClosMake(e0, C38_coerce);
--+         l0->X3_integer = fiClosMake(e0, C39_integer);
--+         l0->X2__STAR_ = fiClosMake(e0, C40__STAR_);
--+         l0->X1__HAT_ = fiClosMake(e0, C41__HAT_);
--+         l0->X0__SLASH_ = fiClosMake(e0, C42__SLASH_);
--+         T3 = fiNew(struct Fmt7 );
--+         T3->X0_size = 7;
--+         T3->X1_nsize = 7;
--+         T3->X2_values = (FiWord) T0;
--+         T4 = fiNew(struct Fmt7 );
--+         T4->X0_size = 7;
--+         T4->X1_nsize = 7;
--+         T4->X2_values = (FiWord) T1;
--+         T5 = fiNew(struct Fmt7 );
--+         T5->X0_size = 7;
--+         T5->X1_nsize = 7;
--+         T5->X2_values = (FiWord) T2;
--+         fiCCall4(void, (*pG_PA5R2_domainAddExports), P0_domain, (FiWord) T3, (
--+         	FiWord) T4, (FiWord) T5);
--+         T6 = fiCCall1(FiWord, (*pG_IJHFC_domainMakeDispatch), P0_domain);
--+         l0->X7__PCENT_ = T6;
--+         l0->X10 = (FiSInt) P1_hashcode;
--+         T15 = fiCCall2(FiClos, (*pG_GOVLL_categoryMake), fiClosMake(e0,
--+         	C35_IntegerMod), fiClosMake(e0, C34_defhash0));
--+         fiCCall3(FiWord, (*pG_V9SO_domainAddDefaults), P0_domain, T15, T6);
--+         fiARRNEW_Word(T7, FiWord*, 1);
--+         T11 = fiEnvPush(fiNew(struct Fmt10 ), e3);
--+         ((PFmt10) fiEnvLevel0(T11))->X0_I = l3->X3_Integer;
--+         ((PFmt10) fiEnvLevel0(T11))->X1 = (FiWord) fiNil;
--+         ((PFmt10) fiEnvLevel0(T11))->X14_dom = ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I;
--+         ((PFmt10) fiEnvLevel0(T11))->X13_mod = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 318461307, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X2__EQ_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200102, (740244383 + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X3__TILDE__EQ_ = CF48_lazyFnGetter(
--+         	e3, ((PFmt10) fiEnvLevel0(T11))->X14_dom, 51509389, (
--+         	740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X9__MINUS_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200086, (fiCCall1(
--+         	FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X7__PLUS_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200084, (fiCCall1(
--+         	FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         T16 = fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I);
--+         ((PFmt10) fiEnvLevel0(T11))->X6_0 = fiCCall3(FiWord, (*
--+         	pG_4NZQI_lazyGetExport_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X14_dom, 200089, T16);
--+         ((PFmt10) fiEnvLevel0(T11))->X5__LT_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200101, (740244383 + (((
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X4__LT__LT_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 51492426, (
--+         	968858812 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 175832832) % 1073741789 & 16777215) << 6)) %
--+         	1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X8_zero_QMARK_ = CF46_lazyFnGetter(
--+         	e3, ((PFmt10) fiEnvLevel0(T11))->X14_dom, 206475020, (
--+         	740244383 + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X12_quo = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 318204816, (
--+         	fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         ((PFmt10) fiEnvLevel0(T11))->X11__STAR_ = CF48_lazyFnGetter(e3, ((
--+         	PFmt10) fiEnvLevel0(T11))->X14_dom, 200083, (fiCCall1(
--+         	FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(
--+         	T11))->X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + (((fiCCall1(FiSInt, (*
--+         	pG_LD0B5_domainHash_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X0_I) + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789);
--+         T16 = fiCCall1(FiSInt, (*pG_LD0B5_domainHash_BANG_), ((PFmt10)
--+         	fiEnvLevel0(T11))->X0_I);
--+         ((PFmt10) fiEnvLevel0(T11))->X10_1 = fiCCall3(FiWord, (*
--+         	pG_4NZQI_lazyGetExport_BANG_), ((PFmt10) fiEnvLevel0(T11))->
--+         	X14_dom, 200090, T16);
--+         fiProgHashCode(fiClosMake(T11, C2_IntegerModRep)->prog) =
--+         	377871722;
--+         T8 = fiClosMake(T11, C2_IntegerModRep);
--+         T7[0] = fiCCall1(FiWord, T8, l2->X0_n);
--+         T9 = fiNew(struct Fmt7 );
--+         T9->X0_size = 1;
--+         T9->X1_nsize = 1;
--+         T9->X2_values = (FiWord) T7;
--+         fiCCall3(FiWord, (*pG_LKD03_domainAddParents), P0_domain, (FiWord) T9,
--+         	T6);
--+         T0[0] = 770345191;
--+         T1[0] = (l0->X10 + 974156096) % 1073741789;
--+         T2[0] = (FiWord) l0->X4_coerce;
--+         T0[1] = 770345191;
--+         T1[1] = (l0->X10 + 296696640) % 1073741789;
--+         T2[1] = (FiWord) l0->X5_coerce;
--+         T0[2] = 477900237;
--+         T1[2] = (l0->X10 + 332724992) % 1073741789;
--+         T2[2] = (FiWord) l0->X3_integer;
--+         T0[3] = 200083;
--+         T1[3] = (l0->X10 + (((l0->X10 + (((
--+         	l0->X10 + 74075968) % 1073741789 & 16777215) << 6)) %
--+         	1073741789 & 16777215) << 6)) % 1073741789;
--+         T2[3] = (FiWord) l0->X2__STAR_;
--+         l0->X12_dom = fiCCall3(FiWord, l3->X2_BinaryPowering, l0->
--+         	X7__PCENT_, l0->X2__STAR_, l3->X3_Integer);
--+         l0->X11_power = CF44_lazyFnGetter(e3, l0->X12_dom, 1046982458, (
--+         	l0->X10 + (((484208045 + (((l0->
--+         	X10 + (((l0->X10 + 74075968) % 1073741789 &
--+         	16777215) << 6)) % 1073741789 & 16777215) << 6)) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         T0[4] = 200135;
--+         T12 = (l0->X10 + 74075968) % 1073741789;
--+         T13 = T12 & 16777215;
--+         T14 = T13 << 6;
--+         T1[4] = (l0->X10 + (((484208045 + T14) %
--+         	1073741789 & 16777215) << 6)) % 1073741789;
--+         T2[4] = (FiWord) l0->X1__HAT_;
--+         T0[5] = 200088;
--+         T1[5] = (l0->X10 + (((l0->X10 + T14) %
--+         	1073741789 & 16777215) << 6)) % 1073741789;
--+         T2[5] = (FiWord) l0->X0__SLASH_;
--+         l0->X6_Rep = fiCCall0(FiWord, (*pG_BEY7_domainMakeDummy));
--+         T10 = l0->X6_Rep;
--+         l0->X6_Rep = l3->X3_Integer;
--+         fiCCall2(void, (*pG_AK1EB_domainFill_BANG_), T10, l0->X6_Rep);
--+         l0->X6_Rep = T10;
--+         T0[6] = 316169058;
--+         T1[6] = 850925108;
--+         T2[6] = l0->X6_Rep;
--+         l0->X8_inv = (FiClos) fiCCall3(FiWord, (*
--+         	pG_1X2RM_domainGetExport_BANG_), T6, 318722696, (l0->
--+         	X10 + (((l0->X10 + 74075968) % 1073741789 &
--+         	16777215) << 6)) % 1073741789);
--+         l0->X9_1 = fiCCall3(FiWord, (*pG_1X2RM_domainGetExport_BANG_),
--+         	T6, 200090, l0->X10);
--+         return P0_domain;
--+ }
--+
--+ static struct _FiProg  tmp33_addLevel1 = {
--+         (FiFun) CF33_addLevel1,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiSInt
--+ CF34_defhash0(e1)
--+         FiEnv e1;
--+ {
--+         PFmt16 l1;
--+         l1 = (PFmt16) fiEnvLevel(e1);
--+         return 845382151;
--+ }
--+
--+ static struct _FiProg  tmp34_defhash0 = {
--+         (FiFun) CF34_defhash0,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static void
--+ CF35_IntegerMod(e1, P0_self, P1_dom)
--+         FiEnv e1;
--+         FiWord P0_self;
--+         FiWord P1_dom;
--+ {
--+         PFmt7 T3, T4, T5, T7;
--+         FiWord *T2, *T6;
--+         FiSInt *T0, *T1;
--+         PFmt15 l0;
--+         FiEnv e4, e3, e2, e0;
--+         PFmt19 l4;
--+         l0 = fiNew(struct Fmt15 );
--+         e0 = fiEnvPush(l0, e1);
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         fiARRNEW_SInt(T0, FiSInt*, 0);
--+         fiARRNEW_SInt(T1, FiSInt*, 0);
--+         fiARRNEW_Word(T2, FiWord*, 0);
--+         l0->X0__PCENT_ = P1_dom;
--+         T3 = fiNew(struct Fmt7 );
--+         T3->X0_size = 0;
--+         T3->X1_nsize = 0;
--+         T3->X2_values = (FiWord) T0;
--+         T4 = fiNew(struct Fmt7 );
--+         T4->X0_size = 0;
--+         T4->X1_nsize = 0;
--+         T4->X2_values = (FiWord) T1;
--+         T5 = fiNew(struct Fmt7 );
--+         T5->X0_size = 0;
--+         T5->X1_nsize = 0;
--+         T5->X2_values = (FiWord) T2;
--+         fiCCall4(void, (*pG_WXLY5_categoryAddExports), P0_self, (FiWord) T3, (
--+         	FiWord) T4, (FiWord) T5);
--+         fiCCall2(FiWord, (*pG_6M45D_categoryAddNameFn), P0_self, fiClosMake(
--+         	e0, C36_addNameFn));
--+         fiARRNEW_Word(T6, FiWord*, 1);
--+         T6[0] = l4->X0_Ring;
--+         T7 = fiNew(struct Fmt7 );
--+         T7->X0_size = 1;
--+         T7->X1_nsize = 1;
--+         T7->X2_values = (FiWord) T6;
--+         fiCCall3(FiWord, (*pG_YXGL3_categoryAddParents), P0_self, (FiWord) T7,
--+         	l0->X0__PCENT_);
--+         return ;
--+ }
--+
--+ static struct _FiProg  tmp35_IntegerMod = {
--+         (FiFun) CF35_IntegerMod,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF36_addNameFn(e1)
--+         FiEnv e1;
--+ {
--+         PFmt5 T1, T3;
--+         FiWord *T0, *T2;
--+         PFmt15 l1;
--+         l1 = (PFmt15) fiEnvLevel(e1);
--+         fiARRNEW_Word(T0, FiWord*, 3);
--+         T0[0] = (FiWord) "(";
--+         T0[1] = (FiWord) "n==<value>";
--+         T0[2] = (FiWord) ")";
--+         T1 = fiNew(struct Fmt5 );
--+         T1->X0_size = 3;
--+         T1->X1_values = (FiWord) T0;
--+         fiARRNEW_Word(T2, FiWord*, 2);
--+         T2[0] = (FiWord) "IntegerMod";
--+         T2[1] = fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T1);
--+         T3 = fiNew(struct Fmt5 );
--+         T3->X0_size = 2;
--+         T3->X1_values = (FiWord) T2;
--+         return fiCCall1(FiWord, (*pG_IK5ZM_stringConcat), (FiWord) T3);
--+ }
--+
--+ static struct _FiProg  tmp36_addNameFn = {
--+         (FiFun) CF36_addNameFn,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF37_coerce(e1, P0_i)
--+         FiEnv e1;
--+         FiWord P0_i;
--+ {
--+         FiBool T2;
--+         FiWord T1;
--+         FiBInt T0;
--+         FiEnv e4, e3, e2;
--+         PFmt17 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt17) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         T1 = l3->X0_n;
--+         fiBINT_REM(T0, FiBInt, fiSIntToBInt((FiSInt) P0_i), (FiBInt) T1);
--+         fiBINT_IS_NEG(T2, FiBool, T0);
--+         if (T2) goto L2;
--+ L1:	return (FiWord) T0;
--+ L2:	fiBINT_PLUS(T0, FiBInt, T0, (FiBInt) T1);
--+         goto L1;
--+ }
--+
--+ static struct _FiProg  tmp37_coerce = {
--+         (FiFun) CF37_coerce,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF38_coerce(e1, P0_i)
--+         FiEnv e1;
--+         FiWord P0_i;
--+ {
--+         FiBool T2;
--+         FiWord T1;
--+         FiBInt T0;
--+         FiEnv e4, e3, e2;
--+         PFmt17 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt17) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         T1 = l3->X0_n;
--+         fiBINT_REM(T0, FiBInt, (FiBInt) P0_i, (FiBInt) T1);
--+         fiBINT_IS_NEG(T2, FiBool, T0);
--+         if (T2) goto L1;
--+ L0:	return (FiWord) T0;
--+ L1:	fiBINT_PLUS(T0, FiBInt, T0, (FiBInt) T1);
--+         goto L0;
--+ }
--+
--+ static struct _FiProg  tmp38_coerce = {
--+         (FiFun) CF38_coerce,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF39_integer(e1, P0_l)
--+         FiEnv e1;
--+         FiWord P0_l;
--+ {
--+         FiBool T2;
--+         FiWord T1;
--+         FiBInt T0;
--+         FiEnv e4, e3, e2;
--+         PFmt17 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt17) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         T1 = l3->X0_n;
--+         fiBINT_REM(T0, FiBInt, fiArrToBInt(P0_l), (FiBInt) T1);
--+         fiBINT_IS_NEG(T2, FiBool, T0);
--+         if (T2) goto L2;
--+ L1:	return (FiWord) T0;
--+ L2:	fiBINT_PLUS(T0, FiBInt, T0, (FiBInt) T1);
--+         goto L1;
--+ }
--+
--+ static struct _FiProg  tmp39_integer = {
--+         (FiFun) CF39_integer,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF40__STAR_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         FiBInt T0, T1;
--+         FiEnv e4, e3, e2;
--+         PFmt17 l3;
--+         PFmt19 l4;
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt17) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         fiBINT_TIMES(T0, FiBInt, (FiBInt) P0_x, (FiBInt) P1_y);
--+         fiBINT_REM(T1, FiBInt, T0, (FiBInt) l3->X0_n);
--+         return (FiWord) T1;
--+ }
--+
--+ static struct _FiProg  tmp40__STAR_ = {
--+         (FiFun) CF40__STAR_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF41__HAT_(e1, P0_x, P1_k)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_k;
--+ {
--+         PFmt16 l1;
--+         l1 = (PFmt16) fiEnvLevel(e1);
--+         return fiCCall3(FiWord, l1->X11_power, l1->X9_1, P0_x, P1_k);
--+ }
--+
--+ static struct _FiProg  tmp41__HAT_ = {
--+         (FiFun) CF41__HAT_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF42__SLASH_(e1, P0_x, P1_y)
--+         FiEnv e1;
--+         FiWord P0_x;
--+         FiWord P1_y;
--+ {
--+         FiBInt T0, T2;
--+         FiWord T1;
--+         PFmt16 l1;
--+         FiEnv e4, e3, e2;
--+         PFmt17 l3;
--+         PFmt19 l4;
--+         l1 = (PFmt16) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         e3 = fiEnvNext(e2);
--+         l3 = (PFmt17) fiEnvLevel(e3);
--+         e4 = fiEnvNext(e3);
--+         l4 = (PFmt19) fiEnvLevel(e4);
--+         T1 = fiCCall1(FiWord, l1->X8_inv, P1_y);
--+         fiBINT_TIMES(T0, FiBInt, (FiBInt) P0_x, (FiBInt) T1);
--+         fiBINT_REM(T2, FiBInt, T0, (FiBInt) l3->X0_n);
--+         return (FiWord) T2;
--+ }
--+
--+ static struct _FiProg  tmp42__SLASH_ = {
--+         (FiFun) CF42__SLASH_,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static void
--+ CF43_lazyGetter2(e1)
--+         FiEnv e1;
--+ {
--+         FiClos T0;
--+         PFmt18 l1;
--+         PFmt19 l2;
--+         FiEnv e2;
--+         l1 = (PFmt18) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         l2 = (PFmt19) fiEnvLevel(e2);
--+         if (l1->X3_flag) goto L0;
--+         T0 = (FiClos) fiCCall3(FiWord, (*pG_1X2RM_domainGetExport_BANG_),
--+         	l1->X0_domain, l1->X1_name, l1->X2_type);
--+         l1->X3_flag = 1;
--+         l1->X4_self->env = T0->env;
--+         l1->X4_self->prog = T0->prog;
--+         fiEnvInfo(e1) = (FiWord) fiNil;
--+ L0:	return ;
--+ }
--+
--+ static struct _FiProg  tmp43_lazyGetter2 = {
--+         (FiFun) CF43_lazyGetter2,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiClos
--+ CF44_lazyFnGetter(e1, P0_domain, P1_name, P2_type)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+         FiSInt P1_name;
--+         FiSInt P2_type;
--+ {
--+         PFmt18 l0;
--+         FiEnv e0;
--+         PFmt19 l1;
--+         l0 = fiNew(struct Fmt18 );
--+         e0 = fiEnvPush(l0, e1);
--+         l1 = (PFmt19) fiEnvLevel(e1);
--+         l0->X0_domain = P0_domain;
--+         l0->X1_name = P1_name;
--+         l0->X2_type = P2_type;
--+         l0->X3_flag = 0;
--+         l0->X4_self = fiClosMake(e0, C45_lazyGetter);
--+         fiEnvInfo(e0) = (FiWord) fiClosMake(e0, C43_lazyGetter2);
--+         return l0->X4_self;
--+ }
--+
--+ static struct _FiProg  tmp44_lazyFnGetter = {
--+         (FiFun) CF44_lazyFnGetter,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF45_lazyGetter(e1, P0_a, P1_b, P2_c)
--+         FiEnv e1;
--+         FiWord P0_a;
--+         FiWord P1_b;
--+         FiWord P2_c;
--+ {
--+         FiClos T0;
--+         PFmt18 l1;
--+         PFmt19 l2;
--+         FiEnv e2;
--+         l1 = (PFmt18) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         l2 = (PFmt19) fiEnvLevel(e2);
--+         if (l1->X3_flag) goto L0;
--+         T0 = (FiClos) fiCCall3(FiWord, (*pG_1X2RM_domainGetExport_BANG_),
--+         	l1->X0_domain, l1->X1_name, l1->X2_type);
--+         l1->X3_flag = 1;
--+         l1->X4_self->env = T0->env;
--+         l1->X4_self->prog = T0->prog;
--+ L0:	return fiCCall3(FiWord, l1->X4_self, P0_a, P1_b, P2_c);
--+ }
--+
--+ static struct _FiProg  tmp45_lazyGetter = {
--+         (FiFun) CF45_lazyGetter,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiClos
--+ CF46_lazyFnGetter(e1, P0_domain, P1_name, P2_type)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+         FiSInt P1_name;
--+         FiSInt P2_type;
--+ {
--+         PFmt18 l0;
--+         FiEnv e0;
--+         PFmt19 l1;
--+         l0 = fiNew(struct Fmt18 );
--+         e0 = fiEnvPush(l0, e1);
--+         l1 = (PFmt19) fiEnvLevel(e1);
--+         l0->X0_domain = P0_domain;
--+         l0->X1_name = P1_name;
--+         l0->X2_type = P2_type;
--+         l0->X3_flag = 0;
--+         l0->X4_self = fiClosMake(e0, C47_lazyGetter);
--+         fiEnvInfo(e0) = (FiWord) fiClosMake(e0, C43_lazyGetter2);
--+         return l0->X4_self;
--+ }
--+
--+ static struct _FiProg  tmp46_lazyFnGetter = {
--+         (FiFun) CF46_lazyFnGetter,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF47_lazyGetter(e1, P0_a)
--+         FiEnv e1;
--+         FiWord P0_a;
--+ {
--+         FiClos T0;
--+         PFmt18 l1;
--+         PFmt19 l2;
--+         FiEnv e2;
--+         l1 = (PFmt18) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         l2 = (PFmt19) fiEnvLevel(e2);
--+         if (l1->X3_flag) goto L0;
--+         T0 = (FiClos) fiCCall3(FiWord, (*pG_1X2RM_domainGetExport_BANG_),
--+         	l1->X0_domain, l1->X1_name, l1->X2_type);
--+         l1->X3_flag = 1;
--+         l1->X4_self->env = T0->env;
--+         l1->X4_self->prog = T0->prog;
--+ L0:	return fiCCall1(FiWord, l1->X4_self, P0_a);
--+ }
--+
--+ static struct _FiProg  tmp47_lazyGetter = {
--+         (FiFun) CF47_lazyGetter,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiClos
--+ CF48_lazyFnGetter(e1, P0_domain, P1_name, P2_type)
--+         FiEnv e1;
--+         FiWord P0_domain;
--+         FiSInt P1_name;
--+         FiSInt P2_type;
--+ {
--+         PFmt18 l0;
--+         FiEnv e0;
--+         PFmt19 l1;
--+         l0 = fiNew(struct Fmt18 );
--+         e0 = fiEnvPush(l0, e1);
--+         l1 = (PFmt19) fiEnvLevel(e1);
--+         l0->X0_domain = P0_domain;
--+         l0->X1_name = P1_name;
--+         l0->X2_type = P2_type;
--+         l0->X3_flag = 0;
--+         l0->X4_self = fiClosMake(e0, C49_lazyGetter);
--+         fiEnvInfo(e0) = (FiWord) fiClosMake(e0, C43_lazyGetter2);
--+         return l0->X4_self;
--+ }
--+
--+ static struct _FiProg  tmp48_lazyFnGetter = {
--+         (FiFun) CF48_lazyFnGetter,
--+         0,
--+         0,
--+         0
--+ };
--+
--+
--+ static FiWord
--+ CF49_lazyGetter(e1, P0_a, P1_b)
--+         FiEnv e1;
--+         FiWord P0_a;
--+         FiWord P1_b;
--+ {
--+         FiClos T0;
--+         PFmt18 l1;
--+         PFmt19 l2;
--+         FiEnv e2;
--+         l1 = (PFmt18) fiEnvLevel(e1);
--+         e2 = fiEnvNext(e1);
--+         l2 = (PFmt19) fiEnvLevel(e2);
--+         if (l1->X3_flag) goto L0;
--+         T0 = (FiClos) fiCCall3(FiWord, (*pG_1X2RM_domainGetExport_BANG_),
--+         	l1->X0_domain, l1->X1_name, l1->X2_type);
--+         l1->X3_flag = 1;
--+         l1->X4_self->env = T0->env;
--+         l1->X4_self->prog = T0->prog;
--+ L0:	return fiCCall2(FiWord, l1->X4_self, P0_a, P1_b);
--+ }
--+
--+ static struct _FiProg  tmp49_lazyGetter = {
--+         (FiFun) CF49_lazyGetter,
--+         0,
--+         0,
--+         0
--+ };
--+ FiClos G_OCS69_imod;
--+
--+ extern int
--+ INIT__0_imod()
--+ {
--+
--+         extern int INIT__0_machine();
--+         extern int INIT__0_bpower();
--+         extern int INIT__0_integer();
--+         extern int INIT__0_sinteger();
--+         extern int INIT__0_ascat();
--+         extern int INIT__0_basic();
--+         extern int INIT__0_string();
--+         extern int INIT__0_outport();
--+         extern int INIT__0_boolean();
--+         extern int INIT__0_runtime();
--+         static int initialized = 0;
--+         if (initialized)
--+                 return 0;
--+         else
--+                 initialized = 1;
--+         C1_IntegerModRep = &tmp1_IntegerModRep;
--+         C2_IntegerModRep = &tmp2_IntegerModRep;
--+         C3_addLevel0 = &tmp3_addLevel0;
--+         C4_addNameFn = &tmp4_addNameFn;
--+         C5_addLevel1 = &tmp5_addLevel1;
--+         C6_coerce = &tmp6_coerce;
--+         C7_zero_QMARK_ = &tmp7_zero_QMARK_;
--+         C8__EQ_ = &tmp8__EQ_;
--+         C9__TILDE__EQ_ = &tmp9__TILDE__EQ_;
--+         C10__PLUS_ = &tmp10__PLUS_;
--+         C11__MINUS_ = &tmp11__MINUS_;
--+         C12__PLUS_ = &tmp12__PLUS_;
--+         C13__MINUS_ = &tmp13__MINUS_;
--+         C14_lift = &tmp14_lift;
--+         C15__LT__LT_ = &tmp15__LT__LT_;
--+         C16_inv = &tmp16_inv;
--+         C17_SmallIntegerMod = &tmp17_SmallIntegerMod;
--+         C18_addLevel0 = &tmp18_addLevel0;
--+         C19_addNameFn = &tmp19_addNameFn;
--+         C20_addLevel1 = &tmp20_addLevel1;
--+         C21_defhash0 = &tmp21_defhash0;
--+         C22_SmallIntegerMod = &tmp22_SmallIntegerMod;
--+         C23_addNameFn = &tmp23_addNameFn;
--+         C24_coerce = &tmp24_coerce;
--+         C25_coerce = &tmp25_coerce;
--+         C26_integer = &tmp26_integer;
--+         C27__HAT_ = &tmp27__HAT_;
--+         C28__SLASH_ = &tmp28__SLASH_;
--+         C29__STAR_ = &tmp29__STAR_;
--+         C30_IntegerMod = &tmp30_IntegerMod;
--+         C31_addLevel0 = &tmp31_addLevel0;
--+         C32_addNameFn = &tmp32_addNameFn;
--+         C33_addLevel1 = &tmp33_addLevel1;
--+         C34_defhash0 = &tmp34_defhash0;
--+         C35_IntegerMod = &tmp35_IntegerMod;
--+         C36_addNameFn = &tmp36_addNameFn;
--+         C37_coerce = &tmp37_coerce;
--+         C38_coerce = &tmp38_coerce;
--+         C39_integer = &tmp39_integer;
--+         C40__STAR_ = &tmp40__STAR_;
--+         C41__HAT_ = &tmp41__HAT_;
--+         C42__SLASH_ = &tmp42__SLASH_;
--+         C43_lazyGetter2 = &tmp43_lazyGetter2;
--+         C44_lazyFnGetter = &tmp44_lazyFnGetter;
--+         C45_lazyGetter = &tmp45_lazyGetter;
--+         C46_lazyFnGetter = &tmp46_lazyFnGetter;
--+         C47_lazyGetter = &tmp47_lazyGetter;
--+         C48_lazyFnGetter = &tmp48_lazyFnGetter;
--+         C49_lazyGetter = &tmp49_lazyGetter;
--+         C0_imod = &tmp0_imod;
--+         fiExportGlobal("G_OCS69_imod", G_OCS69_imod);
--+         fiExportGlobal("G_9JSM3_imod__IntegerMod__7998",
--+         	G_9JSM3_imod__IntegerMod__7998);
--+         fiExportGlobal("G_7PG3N_imod__SmallIntegerMod",
--+         	G_7PG3N_imod__SmallIntegerMod);
--+         fiExportGlobal("G_87K1L_imod__IntegerModRep__6",
--+         	G_87K1L_imod__IntegerModRep__6);
--+         fiImportGlobal("G_NQYQM_noOperation", pG_NQYQM_noOperation);
--+         fiImportGlobal("G_XIPRL_runtime", pG_XIPRL_runtime);
--+         fiImportGlobal("G_QQHP2_rtCacheMake", pG_QQHP2_rtCacheMake);
--+         fiImportGlobal("G_759EG_rtCacheCheck", pG_759EG_rtCacheCheck);
--+         fiImportGlobal("G_LD0B5_domainHash_BANG_", pG_LD0B5_domainHash_BANG_);
--+         fiImportGlobal("G_GJ87F_domainName", pG_GJ87F_domainName);
--+         fiImportGlobal("G_IK5ZM_stringConcat", pG_IK5ZM_stringConcat);
--+         fiImportGlobal("G_CSVBL_domainAddNameFn_BANG_",
--+         	pG_CSVBL_domainAddNameFn_BANG_);
--+         fiImportGlobal("G_XS55O_domainAddHash_BANG_",
--+         	pG_XS55O_domainAddHash_BANG_);
--+         fiImportGlobal("G_PA5R2_domainAddExports_BANG_",
--+         	pG_PA5R2_domainAddExports);
--+         fiImportGlobal("G_IJHFC_domainMakeDispatch",
--+         	pG_IJHFC_domainMakeDispatch);
--+         fiImportGlobal("G_P63GL_boolean", pG_P63GL_boolean);
--+         fiImportGlobal("G_4NZQI_lazyGetExport_BANG_",
--+         	pG_4NZQI_lazyGetExport_BANG_);
--+         fiImportGlobal("G_R3D1K_lazyForceImport", pG_R3D1K_lazyForceImport);
--+         fiImportGlobal("G_BXNX_outport", pG_BXNX_outport);
--+         fiImportGlobal("G_OGNYK_string", pG_OGNYK_string);
--+         fiImportGlobal("G_NO017_basic", pG_NO017_basic);
--+         fiImportGlobal("G_6L1ZC_domainMake", pG_6L1ZC_domainMake);
--+         fiImportGlobal("G_PV28S_rtCacheAdd", pG_PV28S_rtCacheAdd);
--+         fiImportGlobal("G_WXLY5_categoryAddExports",
--+         	pG_WXLY5_categoryAddExports);
--+         fiImportGlobal("G_6M45D_categoryAddNameFn",
--+         	pG_6M45D_categoryAddNameFn);
--+         fiImportGlobal("G_OPE1D_ascat", pG_OPE1D_ascat);
--+         fiImportGlobal("G_WWV15_ascat__Ring__101106965",
--+         	pG_WWV15_ascat__Ring__10110696);
--+         fiImportGlobal("G_YXGL3_categoryAddParents",
--+         	pG_YXGL3_categoryAddParents);
--+         fiImportGlobal("G_GOVLL_categoryMake", pG_GOVLL_categoryMake);
--+         fiImportGlobal("G_V9SO_domainAddDefaults_BANG_",
--+         	pG_V9SO_domainAddDefaults);
--+         fiImportGlobal("G_HAQ5R_sinteger", pG_HAQ5R_sinteger);
--+         fiImportGlobal("G_7PJN6_sinteger__SingleIntege",
--+         	pG_7PJN6_sinteger__SingleInteg);
--+         fiImportGlobal("G_LKD03_domainAddParents_BANG_",
--+         	pG_LKD03_domainAddParents);
--+         fiImportGlobal("G_WJ27Y_integer", pG_WJ27Y_integer);
--+         fiImportGlobal("G_VJ6DK_integer__Integer__6158",
--+         	pG_VJ6DK_integer__Integer__615);
--+         fiImportGlobal("G_FKD29_bpower", pG_FKD29_bpower);
--+         fiImportGlobal("G_2LA6D_bpower__BinaryPowering",
--+         	pG_2LA6D_bpower__BinaryPowerin);
--+         fiImportGlobal("G_JNB1W_machine", pG_JNB1W_machine);
--+         fiImportGlobal("G_BEY7_domainMakeDummy", pG_BEY7_domainMakeDummy);
--+         fiImportGlobal("G_AK1EB_domainFill_BANG_", pG_AK1EB_domainFill_BANG_);
--+         fiImportGlobal("G_1X2RM_domainGetExport_BANG_",
--+         	pG_1X2RM_domainGetExport_BANG_);
--+         fiImportGlobal("G_822GM_rtAddStrings", pG_822GM_rtAddStrings);
--+         if (fiFileInitializer) {
--+                 fiFileInitializer("machine");
--+                 fiFileInitializer("bpower");
--+                 fiFileInitializer("integer");
--+                 fiFileInitializer("sinteger");
--+                 fiFileInitializer("ascat");
--+                 fiFileInitializer("basic");
--+                 fiFileInitializer("string");
--+                 fiFileInitializer("outport");
--+                 fiFileInitializer("boolean");
--+                 fiFileInitializer("runtime");
--+         }
--+         else {
--+                 INIT__0_machine();
--+                 INIT__0_bpower();
--+                 INIT__0_integer();
--+                 INIT__0_sinteger();
--+                 INIT__0_ascat();
--+                 INIT__0_basic();
--+                 INIT__0_string();
--+                 INIT__0_outport();
--+                 INIT__0_boolean();
--+                 INIT__0_runtime();
--+         }
--+         /* "---------------------------" */
--+         return 0;
--+ }
#include "axllib"

ModularIntegerNumberSystem(I) ==> Ring with {
	coerce: I -> %;
	lift:   % -> I;
	inv:    % -> %;
	/:      (%, %) -> %;	-- Or error
}


IntegerModRep(I: IntegerNumberSystem)(n: I): with {
	0:	%;
	1:	%;
	coerce: I -> %;
	zero?:  % -> Boolean;
	=:	(%, %) -> Boolean;
	~=: 	(%, %) -> Boolean;
	+:	% -> %;
	-:	% -> %;
	inv:	% -> %;
	+:	(%, %) -> %;
	-:	(%, %) -> %;
	lift:	% -> I;
	<<:	(OutPort, %) -> OutPort;
}
== add {
	Rep ==> I;
	import from Rep;

	0:% == per 0;
	1:% == per 1;

	coerce(i: I): %             == per(i mod n);
	zero?(x:%): Boolean         == x = 0;
	(x:%) = (y:%): Boolean      == rep(x) = rep(y);
	(x:%)~= (y:%): Boolean      == rep(x) ~= rep(y);
	+ (x:%):%        == x;
	- (x:%):%        == if x = 0 then 0 else per(n - rep x);
	(x:%) + (y:%): % == per(if (z := rep x-n+rep y) < 0 then z+n else z);
	(x:%) - (y:%): % == per(if (z := rep x  -rep y) < 0 then z+n else z);
	lift(x: %): I    == rep x;
	(port: OutPort) << (x:%): OutPort == port << rep x;

	inv(j: %): % == {
		local c0, d0, c1, d1: Rep;
		(c0, d0) := (rep j, n);
		(c1, d1) := (rep 1, 0);
		while not zero? d0 repeat {
			q := c0 quo d0;
			(c0, d0) := (d0, c0 - q*d0);
			(c1, d1) := (d1, c1 - q*d1)
		}
		if c0 ~= 1 then error "inverse does not exist";
		if c1 < 0  then c1 := c1 + n;
		per c1
	}
}


SmallIntegerMod(n: SingleInteger): ModularIntegerNumberSystem(SingleInteger)
== IntegerModRep(SingleInteger)(n) add {
	Rep == SingleInteger;
	coerce(i: SingleInteger): % == per(i mod n);
	coerce(i: Integer): %  == per(retract(i mod n::Integer)@SingleInteger);
	integer(l:Literal):%   == {i: Integer := integer l;  i::%}

	(x:%) ^ (k:Integer): % == power(1, x, k)$BinaryPowering(%, *, Integer);
	(x:%) / (y:%): %       == x * inv y;

	(x: %) * (y: %): % == {
		import from SingleInteger, Machine;
		(xx, yy) := (rep x, rep y);

		-- Small case
		HalfWord ==> 32767; --!! Should be based on max$Rep
		(n < HalfWord) or (xx < HalfWord and yy < HalfWord) => (xx * yy)::%;

		-- Large case
		(nh, nl) := double_*(xx pretend Word, yy pretend Word);
		(qu, rm) := doubleDivide(nh, nl, n pretend Word);
		rm pretend %;
	}
}


IntegerMod(n: Integer): ModularIntegerNumberSystem(Integer)
== IntegerModRep(Integer)(n) add {
	Rep == Integer;
	coerce(i: SingleInteger): % == per(i::Integer mod n);
	coerce(i: Integer): %  == per(i mod n);
	integer(l:Literal):%   == per(integer l mod n);

	(x:%) * (y:%): %       == per((rep x * rep y) rem n);
	(x:%) ^ (k:Integer): % == power(1, x, k)$BinaryPowering(%, *, Integer);
	(x:%) / (y:%): %       == x * inv y;
}
